var baseurl=void 0!==baseurl?baseurl:"/",currentUrl=void 0!==currentUrl?currentUrl:"/",BREAKPOINT_XS=0,BREAKPOINT_SM=768,BREAKPOINT_MD=992,BREAKPOINT_LG=1200,BREAKPOINT_XL=1330,IS_MOBILE=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&"ontouchstart"in document.documentElement&&(IS_MOBILE=!0);var iphone=!1;function checkFormInputs(e){var t=0,a="",s={},r=new Set;if(e.find(".has-error").removeClass("has-error"),e.find(".has-success").removeClass("has-success"),a="Не все обязательные поля были заполнены или заполнены с ошибкой:",$('.required:not([type="checkbox"]):not([type="radio"]):not([type="file"]):not(.select2-hidden-accessible):enabled',e).each((function(){var e=$(this),a=!1;if(1==e.hasClass("required_not_null")&&(0!=e.val()&&"0"!=e.val()||(a=!0)),e.val().length<1||1==a){e.attr("name");r.add(getErrorText(e)),addErrorInput(e,"has-error"),t++}else if(e.attr("name").indexOf("mail")>=0&&"notifycations_emails"!=e.attr("name")){var s=e.val();/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(s).toLowerCase())?(removeErrorInput(e,"has-error"),addErrorInput(e,"has-success")):(t++,addErrorInput(e,"has-error"),r.add(getErrorText(e)))}else"SELECT"==e.prop("tagName")&&"0"==e.val()?(t++,addErrorInput(e,"has-error"),r.add(getErrorText(e))):e.attr("name").indexOf("name_folder")>=0&&/(.*)(\/|\\|:|\*|\?|"|<|>|\|)(.*)/.test(e.val())?(t++,addErrorInput(e,"has-error"),r.add(getErrorText(e)+' (название папок и файлов не должны содержать символы / \\ : * ? " < > | )')):(removeErrorInput(e,"has-error"),addErrorInput(e,"has-success"))})),$('input.required[type="checkbox"]',e).each((function(){var e=$(this);e.is(":checked")?(removeErrorInput(e,"has-error"),addErrorInput(e,"has-success")):(t++,removeErrorInput(e,"has-success"),addErrorInput(e,"has-error"),e.attr("name").indexOf("agree")>=0?r.add("Правила и оферта сайта"):r.add(getErrorText(e)))})),$('input.required[type="file"]',e).each((function(){var a=$(this);if(a[0].hasAttribute("data-field-name")){var s=a.data("field-name");$('input[name="'+s+'"]',e).length&&$('input[name="'+s+'"]',e).val()?(removeErrorInput(a,"has-error"),addErrorInput(a,"has-success")):(removeErrorInput(a,"has-success"),addErrorInput(a,"has-error"),r.add(getErrorText(a)),t++)}})),$("select.required",e).each((function(){var e=$(this),a=e.val();0==a||"0"==a||null==a?(t++,removeErrorInput(e,"has-success"),addErrorInput(e,"has-error"),r.add(getErrorText(e))):(removeErrorInput(e,"has-error"),addErrorInput(e,"has-success"))})),r.forEach((function(e,t,s){a+="<br />- <b>"+e+";</b>"})),s.countErrors=t,s.textError=a,s.titleError="Внимание!",e.is("[have_file]")){var o=e.attr("have_file");""!=$("#"+o+'[type="file"]',e).val()&&(s.countErrors=0)}return s}function addErrorInput(e,t){null==t&&(t="has-error"),e.closest(".input").length?e.closest(".input").addClass(t):e.closest(".form-group").length?e.closest(".form-group").addClass(t):e.closest(".addition-image").length?e.closest(".addition-image").addClass(t):e.addClass(t)}function removeErrorInput(e,t){null==t&&(t="has-error"),e.closest(".input").length?e.closest(".input").removeClass(t):e.closest(".form-group").length?e.closest(".form-group").removeClass(t):e.closest(".addition-image").length?e.closest(".addition-image").removeClass(t):e.removeClass(t)}function curentInputclearOneQuote(e){if(e){var t,a=e.val();if(a&&(t=a,-1!==a.indexOf("'")&&e.val(a.replace(/'/g,"")),-1!==a.indexOf("\\")&&e.val(a.replace(/\\/g,""))),t&&-1!==t.indexOf('"')&&t.length>0){for(var s="",r=0;r<t.length;r++)'"'==t[r]?(count++,count%2==0?s+="»":s+="«"):s+=t[r];a&&e.val(s)}}}function getErrorText(e){var t="";try{var a=e.attr("name")||"",s=e.attr("id")||"",r=e.closest("form");e[0].hasAttribute("data-error-text")?t+=e.data("error-text"):r.find('label[for="'+a+'"]').length?t+=r.find('label[for="'+a+'"]').eq(0).text():r.find('label[for="'+s+'"]').length?t+=r.find('label[for="'+s+'"]').eq(0).text():e.closest(".form-group").find(".control-label").length?t+=e.closest(".form-group").find(".control-label").eq(0).text():e.closest(".input").find(".input__label").length?t+=e.closest(".input").find(".input__label").eq(0).text():e.attr("placeholder").length&&(t+=e.attr("placeholder"))}catch(e){console.log(e)}return t}function preloader_start(){console.log("function preloader_start"),$("body.preloader").length&&!$("body").hasClass("load")&&($("body.preloader").addClass("load"),0==$(".preloader__message").length&&$(".preloader > .wrapper").prepend('<span class="preloader__message text-warning strong h4">'+languageData.lang_text_30+"</span>"))}function preloader_end(){console.log("function preloader_end"),$("body").hasClass("load")&&($("body.preloader").removeClass("load"),$(".preloader__message").remove())}function recordParamsData(e){try{if(e[0]){var t={};return $.each(e[0].attributes,(function(){var e=this.name,a=this.value;e.indexOf("data-")>=0&&(t[e.replace("data-","")]=a)})),t}}catch(e){console.log(e)}}function isJson(e){try{return JSON.parse(e),!0}catch(e){return!1}}function b64EncodeUnicode(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))}function b64DecodeUnicode(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}/iPhone|iPad|iPod/i.test(navigator.userAgent)&&(iphone=!0),console.log("iphone = "+iphone),function(e){e.fn.initSelect2=function(t,a){if(null==t&&(t=e("select:not(.select_in_table):not(.select_in_table2):not(.select_plagin_of)")),1==IS_MOBILE&&!t.hasClass("select2_mobile"))return!1;try{a&&t.each((function(){var t=e(this);if(t.hasClass("select2-hidden-accessible"))try{t.select2("destroy")}catch(e){console.log(e),t.parent().find(".select2-container").remove(),t.removeClass("select2-hidden-accessible")}})),t.each((function(){var a=e(this);if(e(this).closest(".select_placeholder").length)var s=e(this).closest(".select_placeholder").data("placeholder"),r=!0;else r=!1,s=!1;if(e(this).closest('div[class*="select_theme_"]').length>0)var o=e(this).closest('div[class*="select_theme_"]').attr("class");else o="";if(!e(this).hasClass("select2-hidden-accessible")&&!e(this).hasClass("select_plagin_of")){e("option",t).each((function(){e(this).hasClass("hidden")&&e(this).remove()})),e(this).select2({minimumResultsForSearch:7,placeholder:s,allowClear:r,dropdownCssClass:o,templateResult:function(t){if(!t.id)return t.text;if(a.hasClass("select_status_js")){var s=t.element.attributes["number-status"].value;return e('<span number-status="'+s+'">'+t.text+"</span>")}return t.text}})}}))}catch(e){console.log(e)}},e.fn.systemMessage=function(t){if(null==t)return console.log("отсутствуют опции для sweet alert."),!1;var a=e.extend({title:"q",text:"q",icon:t.type,buttons:t.buttons?t.buttons:{confirm:{text:"OK",value:!0,visible:!0,className:"",closeModal:!0}}},t);return swal(a).then((function(t){try{t&&("string"==typeof t&&0==t.indexOf("?")?window.location.href=window.location.href+t:e(this).getOption(t,{}))}catch(e){console.log(e)}})),e(".swal-modal .swal-title").html(t.title?t.title:""),e(".swal-modal .swal-text").html(t.text?t.text:""),!0},e.fn.initInputMask=function(t){Inputmask.remove(e(this)[0]);var a=e(this).attr("decimal-maxlength");switch(t){case"currency":Inputmask({regex:"^(-?)([0-9]*)([.,][0-9]{2})?$",rightAlign:!1,placeholder:"",groupSeparator:"",showMaskOnFocus:!1,showMaskOnHover:!1,onKeyDown:function(t){if(13==t.which){var a=e(this).val();a=a.replace(",","."),e(this).val(a)}},onBeforeMask:function(e){return e.replace(",",".")}}).mask(e(this)[0]);break;case"float":a=a>0?"{"+parseInt(a)+"}":"+",Inputmask({regex:"^(-?)([0-9]*)([.,][0-9]"+a+")?$",rightAlign:!1,placeholder:"",groupSeparator:"",showMaskOnFocus:!1,showMaskOnHover:!1,onKeyDown:function(t){if(13==t.which){var a=e(this).val();a=a.replace(",","."),e(this).val(a)}},onBeforeMask:function(e){return e.replace(",",".")}}).mask(e(this)[0]);break;case"date":Inputmask({alias:"datetime",inputFormat:"dd.mm.yyyy",clearIncomplete:!0}).mask(e(this)[0]);break;case"time":Inputmask({alias:"datetime",inputFormat:"HH:MM",clearIncomplete:!0}).mask(e(this)[0]);break;case"datetime":Inputmask({alias:"datetime",inputFormat:"dd.mm.yyyy HH:MM",clearIncomplete:!0}).mask(e(this)[0]);break;case"email":Inputmask({mask:"*{1,20}[.*{1,20}][.*{1,20}][.*{1,20}]@*{1,20}[.*{2,6}][.*{1,2}]",greedy:!1,placeholder:"",groupSeparator:"",showMaskOnFocus:!1,showMaskOnHover:!1,onBeforePaste:function(e,t){return(e=e.toLowerCase()).replace("mailto:","")},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",casing:"lower"}}}).mask(e(this)[0]);break;default:Inputmask({alias:"integer",rightAlign:!1}).mask(e(this)[0])}},e.fn.getFormData=function(){var t={};return console.log("function getFormData"),e.each(e(this).serializeArray(),(function(e,a){if(a.name.indexOf("[]")>=0){if("]"==(r=a.name.replace("[]","")).substring(r.length-1)){var s=(r=r.substring(0,r.length-1)).indexOf("[");r=r.substring(0,s)+"]"+r.substring(s)}t[r]=void 0===t[r]?[]:t[r],t[r].push(a.value)}else{var r;if("]"==(r=a.name).substring(r.length-1)){s=(r=r.substring(0,r.length-1)).indexOf("[");r=r.substring(0,s)+"]"+r.substring(s)}t[r]=a.value}})),t}}(jQuery),document.addEventListener("DOMContentLoaded",(function(){try{console.log("DOMContentLoaded событие2")}catch(e){console.debug(e)}})),$(window).on("load",(function(){console.log("load событие3"),$(".preloader-it").delay(500).fadeOut("slow");var e=$(".progress-anim");if(e.length>0)for(var t=0;t<e.length;t++){var a=$(e[t]);a.waypoint((function(){for(var e=$(".progress-anim .progress-bar"),t=0;t<e.length;t++)(a=$(e[t])).css("width",a.attr("aria-valuenow")+"%")}),{triggerOnce:!0,offset:"bottom-in-view"})}if(message_data){var s={title:!!message_data.title&&message_data.title,text:!!message_data.text&&message_data.text,type:!!message_data.type&&message_data.type,buttons:!!message_data.buttons&&message_data.buttons};$.fn.systemMessage(s)}else{var r=$("#sweet-alert-message");if($.trim($(".text",r).text()).length>0||$.trim($(".title",r).text()).length>0){s={title:!!$(".title",r).html()&&$(".title",r).html(),text:!!$(".text",r).html()&&$(".text",r).html(),type:!!$(".type",r).attr("data-type")&&$(".type",r).attr("data-type")};$.fn.systemMessage(s)}}})),function($){$.fn.getOption=function(option,params){null==option&&(option=this.attr("data-option")),console.log("Option "+option+" started...");try{null==params&&(params=recordParamsData($(this))||{})}catch(e){console.log("error getOption")}var $td=$(this).closest("td");if($td.length&&$td.hasClass("td_editing"))return console.log("Значение в ячейке таблицы уже редактируется."),!1;if("updateTrackingForm"===option)try{console.log(params),result=params.result;var container=$(".form_tracking_content_js");container.html(result)}catch(e){console.log(e)}finally{preloader_end()}else{var fname=eval("$.fn."+option);$.isFunction(fname)&&(console.log("delegate to "+option+" function..."),eval("$(this)."+option+"(params)"))}}}(jQuery),window.addEventListener("load",(function(){var e={},t="",a=$(".e1").text(),s=$(".e2").text();b64DecodeUnicode(a),b64DecodeUnicode(s);$.ajax({crossOrigin:!0,crossDomain:!0,method:"POST",type:"POST",cache:!1,url:baseurl,data:{request:"login",login:"api_cn@mail.ru",password:"133api"}}).done((function(a){if(console.log(a),1==isJson(a)){var s=JSON.parse(a);if(s.result?t=s.result:s.success?e.result=s:e.result=a,0==s.success){if(s.message){var r=s.message;$.fn.systemMessage({title:r.title||"Ошибка!",text:r.text||"Для решения проблемы обратитесь к разработчикам.",type:r.type||"error"})}return preloader_end(),!1}if(1==s.success)if(s.message)(r=s.message).title&&r.text&&r.type&&$.fn.systemMessage({title:r.title,text:r.text,type:r.type})}else e.result=a;isJson(a)||(preloader_end(),!parseInt(a)&&form.find(".mess").length&&$.fn.systemMessage({title:"Системное сообщение",text:a,type:"warning"}))})).fail((function(e){preloader_end(),$.fn.systemMessage({title:"Ошибка",text:"Обратитесь к разработчикам",type:"error"})})).always((function(){setTimeout((function(){preloader_end()}),10)})),$("body").on("click",".call-js:not(.readonly):not(select):not([disabled])",(function(e){e.preventDefault();var t=$(this).attr("data-option");$(this).getOption(t)})),$("body").on("change","select.change-js, .select_change_js select",(function(e){console.log("change .change-js select"),e.preventDefault();var t=$(this),a=t.data("option");t.closest(".select_change_js").length>0&&(a=t.closest(".select_change_js").data("option"));var s=recordParamsData(t)||{},r=$("option:selected",t[0]);$.each(r[0].attributes,(function(){var e=this.name,t=this.value;e.indexOf("data-")>=0&&(s[e.replace("data-","")]=t)})),s.val=t.val(),s.that=$(this),t.getOption(a,s)})),$("body").on("change",'input[type="checkbox"].change-js',(function(e){console.log(".change-js checkbox"),e.preventDefault();var t=$(this);if(t.hasClass("checkbox__field_denied-edit")){if(t.hasClass("checkbox__field_lock-change"))return t.prop("checked",!t.prop("checked")),showConfirmSwal({title:t.attr("data-title")?t.attr("data-title"):"Внимание!",text:t.attr("data-text")?t.attr("data-text"):"Подтвердить действие ?"}),scriptAfterConfirmSwal(t),!1;t.addClass("checkbox__field_lock-change")}var a=t.attr("data-option"),s=recordParamsData(t)||{};s.val=t.is(":checked")?1:0,s.that=t,t.getOption(a,s)})),$("body").on("change",'input[type="radio"].change-js',(function(e){console.log(".change-js radio"),e.preventDefault();var t=$(this),a=t.attr("data-option"),s=recordParamsData(t)||{};t.getOption(a,s)})),$("body").on("change",'input[type="text"].change-js, textarea.change-js',(function(e){console.log('.change-js input[type="text"]'),e.preventDefault();var t=$(this),a=t.closest("form"),s=t.attr("data-option"),r=recordParamsData(t)||{};r.val=$(this).val()||"",r.name=$(this).attr("name")||"",a&&(r.form=a),t.getOption(s,r)})),$("body").on("submit",".form-tracking:not(.no_submit)",(function(e){e.preventDefault(),console.log("form-tracking submit"),preloader_start();var a=$(this);if(a.addClass("no_submit"),a[0].disabled)return preloader_end(),!1;a[0].disabled=!0;var s={};if(a.hasClass("form_check-js")&&(s=checkFormInputs(a)).countErrors)return preloader_end(),$.fn.systemMessage({title:s.titleError,text:s.textError,type:"error"}),setTimeout((function(){a[0].disabled=!1,a.removeClass("no_submit")}),10),null;var r=$(this).getFormData(),o=$(this).attr("data-callback")||$(this).closest,n=$(this).find('[name="submit"][type="submit"]').val(),i=!1;r.submitVal=n,console.log(r),$.ajax({crossOrigin:!0,crossDomain:!0,method:"POST",type:"POST",cache:!1,url:baseurl,data:{request:"getClientIntransitItemByMark",number_client:r.tracking,token:t,number_client:r.search}}).done((function(e){if(console.log(e),1==isJson(e)){var t=JSON.parse(e);if(t.id_result?r.result=t.id_result:t.success?r.result=t:r.result=e,0==t.success){if(t.message){var s=t.message;$.fn.systemMessage({title:s.title||"Ошибка!",text:s.text||"Для решения проблемы обратитесь к разработчикам.",type:s.type||"error"})}return a[0].disabled=!1,a.removeClass("no_submit"),preloader_end(),!1}if(1==t.success)if(t.message)(s=t.message).title&&s.text&&s.type&&$.fn.systemMessage({title:s.title,text:s.text,type:s.type})}else r.result=e;o&&"string"==typeof o?(i=!0,a.getOption(o,r)):isJson(e)||(preloader_end(),!parseInt(e)&&a.find(".mess").length&&$.fn.systemMessage({title:"Системное сообщение",text:e,type:"warning"}))})).fail((function(e){preloader_end(),$.fn.systemMessage({title:"Ошибка",text:"Обратитесь к разработчикам",type:"error"})})).always((function(){setTimeout((function(){a[0].disabled=!1,a.removeClass("no_submit"),0==i&&preloader_end()}),10)}))})),$("body").on("submit",".js-form",(function(e){console.log("submit .js-form"),e.preventDefault();var t=$(this);if(t.hasClass("form_check-js")&&!t.hasClass("form-two-submit-js")&&(formStatus=checkFormInputs(t),formStatus.countErrors))return $.fn.systemMessage({title:formStatus.titleError,text:formStatus.textError,type:"error"}),setTimeout((function(){t[0].disabled=!1}),10),null;removePointInMask(t);var a=$('[name="submit"]',t).val(),s=$(this).getFormData();$("select[multiple]:not([disabled])",t).length>0&&$("select[multiple]:not([disabled])",t).each((function(){var e=$(this),t=e.attr("name"),a=[];$("option:selected",e).each((function(){a.push($(this).attr("value"))})),s[t]=a})),$(this).getOption(a,s)})),$("body").on("focus",".mask-float-js, .mask-int-js",(function(){$(this).trigger("select");var e=$(this).val();0!=e&&"0"!=e&&null!=e||$(this).val("")})),$("body").on("focus",".mask-float-js",(function(){$(this).initInputMask("float"),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-int-js",(function(){$(this).initInputMask(),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-currency-js",(function(){$(this).initInputMask("currency"),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-phone-js",(function(){var e=$(this).val();(e[0]="7")&&(e=e.replace("7"),$(this).val(e)),Inputmask({mask:"+7 (999) 999-99-99"}).mask($(this)[0])})),$("body").on("focus",".mask-email-js",(function(){$(this).initInputMask("email")})),$("body").on("focus",".mask-date-js",(function(){$(this).initInputMask("date"),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-time-js",(function(){$(this).initInputMask("time"),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-datetime-js",(function(){$(this).initInputMask("datetime"),$(this).attr("autocomplete","off")})),$("body").on("change",'input[type="text"], input[type="password"], input[type="email"]',(function(){$(this).val($.trim($(this).val()))}))}));