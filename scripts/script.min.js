var baseurl=void 0!==baseurl?baseurl:"/",currentUrl=void 0!==currentUrl?currentUrl:"/",BREAKPOINT_XS=0,BREAKPOINT_SM=768,BREAKPOINT_MD=992,BREAKPOINT_LG=1200,BREAKPOINT_XL=1330,IS_MOBILE=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&"ontouchstart"in document.documentElement&&(IS_MOBILE=!0);var iphone=!1;function checkFormInputs(t){var e=0,a="",s={},r=new Set;if(t.find(".has-error").removeClass("has-error"),t.find(".has-success").removeClass("has-success"),a="Не все обязательные поля были заполнены или заполнены с ошибкой:",$('.required:not([type="checkbox"]):not([type="radio"]):not([type="file"]):not(.select2-hidden-accessible):enabled',t).each((function(){var t=$(this),a=!1;if(1==t.hasClass("required_not_null")&&(0!=t.val()&&"0"!=t.val()||(a=!0)),t.val().length<1||1==a){t.attr("name");r.add(getErrorText(t)),addErrorInput(t,"has-error"),e++}else if(t.attr("name").indexOf("mail")>=0&&"notifycations_emails"!=t.attr("name")){var s=t.val();/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(s).toLowerCase())?(removeErrorInput(t,"has-error"),addErrorInput(t,"has-success")):(e++,addErrorInput(t,"has-error"),r.add(getErrorText(t)))}else"SELECT"==t.prop("tagName")&&"0"==t.val()?(e++,addErrorInput(t,"has-error"),r.add(getErrorText(t))):t.attr("name").indexOf("name_folder")>=0&&/(.*)(\/|\\|:|\*|\?|"|<|>|\|)(.*)/.test(t.val())?(e++,addErrorInput(t,"has-error"),r.add(getErrorText(t)+' (название папок и файлов не должны содержать символы / \\ : * ? " < > | )')):(removeErrorInput(t,"has-error"),addErrorInput(t,"has-success"))})),$('input.required[type="checkbox"]',t).each((function(){var t=$(this);t.is(":checked")?(removeErrorInput(t,"has-error"),addErrorInput(t,"has-success")):(e++,removeErrorInput(t,"has-success"),addErrorInput(t,"has-error"),t.attr("name").indexOf("agree")>=0?r.add("Правила и оферта сайта"):r.add(getErrorText(t)))})),$('input.required[type="file"]',t).each((function(){var a=$(this);if(a[0].hasAttribute("data-field-name")){var s=a.data("field-name");$('input[name="'+s+'"]',t).length&&$('input[name="'+s+'"]',t).val()?(removeErrorInput(a,"has-error"),addErrorInput(a,"has-success")):(removeErrorInput(a,"has-success"),addErrorInput(a,"has-error"),r.add(getErrorText(a)),e++)}})),$("select.required",t).each((function(){var t=$(this),a=t.val();0==a||"0"==a||null==a?(e++,removeErrorInput(t,"has-success"),addErrorInput(t,"has-error"),r.add(getErrorText(t))):(removeErrorInput(t,"has-error"),addErrorInput(t,"has-success"))})),r.forEach((function(t,e,s){a+="<br />- <b>"+t+";</b>"})),s.countErrors=e,s.textError=a,s.titleError="Внимание!",t.is("[have_file]")){var n=t.attr("have_file");""!=$("#"+n+'[type="file"]',t).val()&&(s.countErrors=0)}return s}function addErrorInput(t,e){null==e&&(e="has-error"),t.closest(".input").length?t.closest(".input").addClass(e):t.closest(".form-group").length?t.closest(".form-group").addClass(e):t.closest(".addition-image").length?t.closest(".addition-image").addClass(e):t.addClass(e)}function removeErrorInput(t,e){null==e&&(e="has-error"),t.closest(".input").length?t.closest(".input").removeClass(e):t.closest(".form-group").length?t.closest(".form-group").removeClass(e):t.closest(".addition-image").length?t.closest(".addition-image").removeClass(e):t.removeClass(e)}function curentInputclearOneQuote(t){if(t){var e,a=t.val();if(a&&(e=a,-1!==a.indexOf("'")&&t.val(a.replace(/'/g,"")),-1!==a.indexOf("\\")&&t.val(a.replace(/\\/g,""))),e&&-1!==e.indexOf('"')&&e.length>0){for(var s="",r=0;r<e.length;r++)'"'==e[r]?(count++,count%2==0?s+="»":s+="«"):s+=e[r];a&&t.val(s)}}}function getErrorText(t){var e="";try{var a=t.attr("name")||"",s=t.attr("id")||"",r=t.closest("form");t[0].hasAttribute("data-error-text")?e+=t.data("error-text"):r.find('label[for="'+a+'"]').length?e+=r.find('label[for="'+a+'"]').eq(0).text():r.find('label[for="'+s+'"]').length?e+=r.find('label[for="'+s+'"]').eq(0).text():t.closest(".form-group").find(".control-label").length?e+=t.closest(".form-group").find(".control-label").eq(0).text():t.closest(".input").find(".input__label").length?e+=t.closest(".input").find(".input__label").eq(0).text():t.attr("placeholder").length&&(e+=t.attr("placeholder"))}catch(t){console.log(t)}return e}function preloader_start(){console.log("function preloader_start"),$("body.preloader").length&&!$("body").hasClass("load")&&($("body.preloader").addClass("load"),0==$(".preloader__message").length&&$(".preloader > .wrapper").prepend('<span class="preloader__message text-warning strong h4">'+languageData.lang_text_30+"</span>"))}function preloader_end(){console.log("function preloader_end"),$("body").hasClass("load")&&($("body.preloader").removeClass("load"),$(".preloader__message").remove())}function recordParamsData(t){try{if(t[0]){var e={};return $.each(t[0].attributes,(function(){var t=this.name,a=this.value;t.indexOf("data-")>=0&&(e[t.replace("data-","")]=a)})),e}}catch(t){console.log(t)}}function isJson(t){try{return JSON.parse(t),!0}catch(t){return!1}}function b64EncodeUnicode(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode("0x"+e)})))}function b64DecodeUnicode(t){return decodeURIComponent(atob(t).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""))}/iPhone|iPad|iPod/i.test(navigator.userAgent)&&(iphone=!0),console.log("iphone = "+iphone),function(t){t.fn.initSelect2=function(e,a){if(null==e&&(e=t("select:not(.select_in_table):not(.select_in_table2):not(.select_plagin_of)")),1==IS_MOBILE&&!e.hasClass("select2_mobile"))return!1;try{a&&e.each((function(){var e=t(this);if(e.hasClass("select2-hidden-accessible"))try{e.select2("destroy")}catch(t){console.log(t),e.parent().find(".select2-container").remove(),e.removeClass("select2-hidden-accessible")}})),e.each((function(){var a=t(this);if(t(this).closest(".select_placeholder").length)var s=t(this).closest(".select_placeholder").data("placeholder"),r=!0;else r=!1,s=!1;if(t(this).closest('div[class*="select_theme_"]').length>0)var n=t(this).closest('div[class*="select_theme_"]').attr("class");else n="";if(!t(this).hasClass("select2-hidden-accessible")&&!t(this).hasClass("select_plagin_of")){t("option",e).each((function(){t(this).hasClass("hidden")&&t(this).remove()})),t(this).select2({minimumResultsForSearch:7,placeholder:s,allowClear:r,dropdownCssClass:n,templateResult:function(e){if(!e.id)return e.text;if(a.hasClass("select_status_js")){var s=e.element.attributes["number-status"].value;return t('<span number-status="'+s+'">'+e.text+"</span>")}return e.text}})}}))}catch(t){console.log(t)}},t.fn.systemMessage=function(e){if(null==e)return console.log("отсутствуют опции для sweet alert."),!1;var a=t.extend({title:"q",text:"q",icon:e.type,buttons:e.buttons?e.buttons:{confirm:{text:"OK",value:!0,visible:!0,className:"",closeModal:!0}}},e);return swal(a).then((function(e){try{e&&("string"==typeof e&&0==e.indexOf("?")?window.location.href=window.location.href+e:t(this).getOption(e,{}))}catch(t){console.log(t)}})),t(".swal-modal .swal-title").html(e.title?e.title:""),t(".swal-modal .swal-text").html(e.text?e.text:""),!0},t.fn.initInputMask=function(e){Inputmask.remove(t(this)[0]);var a=t(this).attr("decimal-maxlength");switch(e){case"currency":Inputmask({regex:"^(-?)([0-9]*)([.,][0-9]{2})?$",rightAlign:!1,placeholder:"",groupSeparator:"",showMaskOnFocus:!1,showMaskOnHover:!1,onKeyDown:function(e){if(13==e.which){var a=t(this).val();a=a.replace(",","."),t(this).val(a)}},onBeforeMask:function(t){return t.replace(",",".")}}).mask(t(this)[0]);break;case"float":a=a>0?"{"+parseInt(a)+"}":"+",Inputmask({regex:"^(-?)([0-9]*)([.,][0-9]"+a+")?$",rightAlign:!1,placeholder:"",groupSeparator:"",showMaskOnFocus:!1,showMaskOnHover:!1,onKeyDown:function(e){if(13==e.which){var a=t(this).val();a=a.replace(",","."),t(this).val(a)}},onBeforeMask:function(t){return t.replace(",",".")}}).mask(t(this)[0]);break;case"date":Inputmask({alias:"datetime",inputFormat:"dd.mm.yyyy",clearIncomplete:!0}).mask(t(this)[0]);break;case"time":Inputmask({alias:"datetime",inputFormat:"HH:MM",clearIncomplete:!0}).mask(t(this)[0]);break;case"datetime":Inputmask({alias:"datetime",inputFormat:"dd.mm.yyyy HH:MM",clearIncomplete:!0}).mask(t(this)[0]);break;case"email":Inputmask({mask:"*{1,20}[.*{1,20}][.*{1,20}][.*{1,20}]@*{1,20}[.*{2,6}][.*{1,2}]",greedy:!1,placeholder:"",groupSeparator:"",showMaskOnFocus:!1,showMaskOnHover:!1,onBeforePaste:function(t,e){return(t=t.toLowerCase()).replace("mailto:","")},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",casing:"lower"}}}).mask(t(this)[0]);break;default:Inputmask({alias:"integer",rightAlign:!1}).mask(t(this)[0])}},t.fn.getFormData=function(){var e={};return console.log("function getFormData"),t.each(t(this).serializeArray(),(function(t,a){if(a.name.indexOf("[]")>=0){if("]"==(r=a.name.replace("[]","")).substring(r.length-1)){var s=(r=r.substring(0,r.length-1)).indexOf("[");r=r.substring(0,s)+"]"+r.substring(s)}e[r]=void 0===e[r]?[]:e[r],e[r].push(a.value)}else{var r;if("]"==(r=a.name).substring(r.length-1)){s=(r=r.substring(0,r.length-1)).indexOf("[");r=r.substring(0,s)+"]"+r.substring(s)}e[r]=a.value}})),e}}(jQuery),document.addEventListener("DOMContentLoaded",(function(){try{console.log("DOMContentLoaded событие2")}catch(t){console.debug(t)}})),$(window).on("load",(function(){console.log("load событие3"),$(".preloader-it").delay(500).fadeOut("slow");var t=$(".progress-anim");if(t.length>0)for(var e=0;e<t.length;e++){var a=$(t[e]);a.waypoint((function(){for(var t=$(".progress-anim .progress-bar"),e=0;e<t.length;e++)(a=$(t[e])).css("width",a.attr("aria-valuenow")+"%")}),{triggerOnce:!0,offset:"bottom-in-view"})}if(message_data){var s={title:!!message_data.title&&message_data.title,text:!!message_data.text&&message_data.text,type:!!message_data.type&&message_data.type,buttons:!!message_data.buttons&&message_data.buttons};$.fn.systemMessage(s)}else{var r=$("#sweet-alert-message");if($.trim($(".text",r).text()).length>0||$.trim($(".title",r).text()).length>0){s={title:!!$(".title",r).html()&&$(".title",r).html(),text:!!$(".text",r).html()&&$(".text",r).html(),type:!!$(".type",r).attr("data-type")&&$(".type",r).attr("data-type")};$.fn.systemMessage(s)}}})),function($){$.fn.getOption=function(option,params){null==option&&(option=this.attr("data-option")),console.log("Option "+option+" started...");try{null==params&&(params=recordParamsData($(this))||{})}catch(t){console.log("error getOption")}var $td=$(this).closest("td");if($td.length&&$td.hasClass("td_editing"))return console.log("Значение в ячейке таблицы уже редактируется."),!1;switch(option){case"getContainerJs":console.log(params);var $btn=$(this);if(params.container&&params.sources){var html=$(params.sources).html(),container=$btn.closest(params.container);if(container.append(html),params.item&&params.key_text){var i=1;$(params.item,container).each((function(){var t=$(this);$(params.key_text,t).text(i),i++}))}}break;case"removeItem":var $btn=$(this),target_remove=$btn.data("block-remove"),$form=!1;if($btn.closest("form").length>0&&($form=$btn.closest("form")),$btn.is("[data-container]")){var container=$btn.attr("data-container");container=$btn.closest(container)}if($btn.is('[data-last="true"]')&&$btn.is("[data-container]")){var count=$(target_remove,container).length,target_attr=!1,target_text=!1;if($btn.is("[data-attr_key]")&&(target_attr=$btn.attr("data-attr_key")),$btn.is("[data-key_text]")&&(target_text=$btn.attr("data-key_text")),count>1?$btn.closest(target_remove).remove():$.fn.systemMessage({title:"Предупреждение!",text:"Невозможно удалить последний элемент",type:"warning"}),0!=target_attr){var i=0;$(target_remove,container).each((function(){$(this).attr(target_attr,i),i++}))}if(0!=target_text){var i=1;$(target_remove,container).each((function(){var t=$(this);$(target_text,t).text(i),i++}))}}else $btn.closest(target_remove).remove();break;case"updateTrackingForm":try{result=params.result;var container=$(".form_tracking_content_js");container.html(result)}catch(t){console.log(t)}finally{preloader_end()}break;default:var fname=eval("$.fn."+option);$.isFunction(fname)&&(console.log("delegate to "+option+" function..."),eval("$(this)."+option+"(params)"))}}}(jQuery),window.addEventListener("load",(function(){$("body").on("click",".call-js:not(.readonly):not(select):not([disabled])",(function(t){t.preventDefault();var e=$(this).attr("data-option");$(this).getOption(e)})),$("body").on("change","select.change-js, .select_change_js select",(function(t){console.log("change .change-js select"),t.preventDefault();var e=$(this),a=e.data("option");e.closest(".select_change_js").length>0&&(a=e.closest(".select_change_js").data("option"));var s=recordParamsData(e)||{},r=$("option:selected",e[0]);$.each(r[0].attributes,(function(){var t=this.name,e=this.value;t.indexOf("data-")>=0&&(s[t.replace("data-","")]=e)})),s.val=e.val(),s.that=$(this),e.getOption(a,s)})),$("body").on("change",'input[type="checkbox"].change-js',(function(t){console.log(".change-js checkbox"),t.preventDefault();var e=$(this);if(e.hasClass("checkbox__field_denied-edit")){if(e.hasClass("checkbox__field_lock-change"))return e.prop("checked",!e.prop("checked")),showConfirmSwal({title:e.attr("data-title")?e.attr("data-title"):"Внимание!",text:e.attr("data-text")?e.attr("data-text"):"Подтвердить действие ?"}),scriptAfterConfirmSwal(e),!1;e.addClass("checkbox__field_lock-change")}var a=e.attr("data-option"),s=recordParamsData(e)||{};s.val=e.is(":checked")?1:0,s.that=e,e.getOption(a,s)})),$("body").on("change",'input[type="radio"].change-js',(function(t){console.log(".change-js radio"),t.preventDefault();var e=$(this),a=e.attr("data-option"),s=recordParamsData(e)||{};e.getOption(a,s)})),$("body").on("change",'input[type="text"].change-js, textarea.change-js',(function(t){console.log('.change-js input[type="text"]'),t.preventDefault();var e=$(this),a=e.closest("form"),s=e.attr("data-option"),r=recordParamsData(e)||{};r.val=$(this).val()||"",r.name=$(this).attr("name")||"",a&&(r.form=a),e.getOption(s,r)})),$("body").on("submit",".form-tracking:not(.no_submit)",(function(t){t.preventDefault(),console.log("form-tracking submit"),preloader_start();var e=$(this),a=$(this).getFormData();if(e.addClass("no_submit"),e[0].disabled)return preloader_end(),!1;e[0].disabled=!0;var s={};if(e.hasClass("form_check-js")&&(s=checkFormInputs(e)).countErrors)return preloader_end(),$.fn.systemMessage({title:s.titleError,text:s.textError,type:"error"}),setTimeout((function(){e[0].disabled=!1,e.removeClass("no_submit")}),10),null;var r="";$.ajax({crossOrigin:!0,crossDomain:!0,method:"POST",type:"POST",cache:!1,url:baseurl,data:{request:"login",login:"api_crm@hl-group.ru",password:"b83cf54810c924db2ccff0a242188ad6"}}).done((function(t){if(1==isJson(t)){var s=JSON.parse(t);if(0==s.success){if(s.message){var n=s.message;$.fn.systemMessage({title:n.title||"Ошибка!",text:n.text||"Для решения проблемы обратитесь к разработчикам.",type:n.type||"error"})}return e[0].disabled=!1,e.removeClass("no_submit"),preloader_end(),!1}if(1==s.success){if(s.message)(n=s.message).title&&n.text&&n.type&&$.fn.systemMessage({title:n.title,text:n.text,type:n.type});if(s.result){r=s.result;var o=$(".container_tracking_js");$.ajax({crossOrigin:!0,crossDomain:!0,method:"POST",type:"POST",cache:!1,url:baseurl,data:{request:"getClientIntransitItemByMark",number_client:a.tracking,token:r,html:!0}}).done((function(t){if(o.removeClass("start_js"),1==isJson(t)){var a=JSON.parse(t);if(1!=a.success)return o.addClass("empty_js"),$(".form_tracking_content_js",o).html(""),e[0].disabled=!1,e.removeClass("no_submit"),preloader_end(),!1;if(a.result?($(".form_tracking_content_js",o).html(a.result),o.removeClass("empty_js")):o.addClass("empty_js"),a.message){var s=a.message;s.title&&s.text&&s.type&&$.fn.systemMessage({title:s.title,text:s.text,type:s.type})}}else isJson(t)||(preloader_end(),!parseInt(t)&&e.find(".mess").length&&$.fn.systemMessage({title:"Системное сообщение",text:t,type:"warning"}))}))}}}isJson(t)||(preloader_end(),!parseInt(t)&&e.find(".mess").length&&$.fn.systemMessage({title:"Системное сообщение",text:t,type:"warning"}))})).fail((function(t){setTimeout((function(){e[0].disabled=!1,e.removeClass("no_submit"),preloader_end()}),10)})).always((function(){setTimeout((function(){e[0].disabled=!1,e.removeClass("no_submit"),preloader_end()}),10)}))})),$("body").on("submit",".js-form",(function(t){console.log("submit .js-form"),t.preventDefault();var e=$(this);if(e.hasClass("form_check-js")&&!e.hasClass("form-two-submit-js")&&(formStatus=checkFormInputs(e),formStatus.countErrors))return $.fn.systemMessage({title:formStatus.titleError,text:formStatus.textError,type:"error"}),setTimeout((function(){e[0].disabled=!1}),10),null;removePointInMask(e);var a=$('[name="submit"]',e).val(),s=$(this).getFormData();$("select[multiple]:not([disabled])",e).length>0&&$("select[multiple]:not([disabled])",e).each((function(){var t=$(this),e=t.attr("name"),a=[];$("option:selected",t).each((function(){a.push($(this).attr("value"))})),s[e]=a})),$(this).getOption(a,s)})),$("body").on("focus",".mask-float-js, .mask-int-js",(function(){$(this).trigger("select");var t=$(this).val();0!=t&&"0"!=t&&null!=t||$(this).val("")})),$("body").on("focus",".mask-float-js",(function(){$(this).initInputMask("float"),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-int-js",(function(){$(this).initInputMask(),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-currency-js",(function(){$(this).initInputMask("currency"),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-phone-js",(function(){var t=$(this).val();(t[0]="7")&&(t=t.replace("7"),$(this).val(t)),Inputmask({mask:"+7 (999) 999-99-99"}).mask($(this)[0])})),$("body").on("focus",".mask-email-js",(function(){$(this).initInputMask("email")})),$("body").on("focus",".mask-date-js",(function(){$(this).initInputMask("date"),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-time-js",(function(){$(this).initInputMask("time"),$(this).attr("autocomplete","off")})),$("body").on("focus",".mask-datetime-js",(function(){$(this).initInputMask("datetime"),$(this).attr("autocomplete","off")})),$("body").on("change",'input[type="text"], input[type="password"], input[type="email"]',(function(){$(this).val($.trim($(this).val()))}))}));